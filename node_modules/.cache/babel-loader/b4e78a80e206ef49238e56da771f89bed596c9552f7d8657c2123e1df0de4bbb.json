{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport login from '../views/login.vue';\nimport about from '../views/About.vue';\nimport home from '../views/Home.vue';\nimport contact from '../views/Contact.vue';\nimport member from '../views/Members.vue';\nimport Store from '../store';\nimport Callback from '../views/callback.vue';\nimport seleccionUsuario from '../views/seleccionUsuario.vue';\nimport formEmpresa from '../views/formEmpresa.vue';\nconst routes = [{\n  path: '/callback',\n  name: 'Callback',\n  component: Callback\n}, {\n  path: '/login',\n  name: 'login',\n  component: login\n}, {\n  path: '/about',\n  name: 'about',\n  component: about\n}, {\n  path: '/',\n  name: 'home',\n  component: home\n}, {\n  path: '/contact',\n  name: 'contact',\n  component: contact,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/members',\n  name: 'member',\n  component: member,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/seleccionUsuario',\n  name: 'seleccionUsuario',\n  component: seleccionUsuario,\n  meta: {\n    requiresAuth: true\n  }\n}];\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n});\nrouter.beforeEach((to, from, next) => {\n  //\n  if (to.matched.some(record => record.path == '/callback')) {\n    console.log('router.beforeEach found /callback url');\n    Store.dispatch('auth0HandleAuthentication');\n    next(false);\n  }\n  let routerAuthCheck = false;\n  if (localStorage.getItem('access_token') && localStorage.getItem('id_token') && localStorage.getItem('expires_at')) {\n    console.log('found local storage tokens');\n    let expiresAt = JSON.parse(localStorage.getItem('expires_at'));\n    routerAuthCheck = new Date().getDate() < expiresAt;\n  }\n  Store.commit('setUserIsAuthenticated', routerAuthCheck);\n  if (routerAuthCheck) {\n    Store.commit('setUserIsAuthenticated', true);\n  } else {\n    Store.commit('setUserIsAuthenticated', false);\n  }\n  if (to.matched.some(record => record.meta.requiresAuth)) {\n    if (routerAuthCheck) {\n      next();\n    } else {\n      router.replace('/login');\n    }\n  } else {\n    next();\n  }\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","login","about","home","contact","member","Store","Callback","seleccionUsuario","formEmpresa","routes","path","name","component","meta","requiresAuth","router","history","process","env","BASE_URL","beforeEach","to","from","next","matched","some","record","console","log","dispatch","routerAuthCheck","localStorage","getItem","expiresAt","JSON","parse","Date","getDate","commit","replace"],"sources":["R:/Agus/Facultad/TFI 5to/healthchain-front/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\r\nimport login from '../views/login.vue'\r\nimport about from '../views/About.vue'\r\nimport home from '../views/Home.vue'\r\nimport contact from '../views/Contact.vue'\r\nimport member from '../views/Members.vue'\r\nimport Store from '../store'\r\nimport Callback from '../views/callback.vue'\r\nimport seleccionUsuario from '../views/seleccionUsuario.vue'\r\nimport formEmpresa from '../views/formEmpresa.vue'\r\n\r\n\r\nconst routes = [\r\n  {\r\n    path: '/callback',\r\n    name: 'Callback',\r\n    component: Callback\r\n  },\r\n  {\r\n    path: '/login',\r\n    name: 'login',\r\n    component: login\r\n  },\r\n  {\r\n    path: '/about',\r\n    name: 'about',\r\n    component: about\r\n  },\r\n  {\r\n    path: '/',\r\n    name: 'home',\r\n    component: home\r\n  },\r\n  {\r\n    path: '/contact',\r\n    name: 'contact',\r\n    component: contact,\r\n    meta: {requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/members',\r\n    name: 'member',\r\n    component: member,\r\n    meta: {requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/seleccionUsuario',\r\n    name: 'seleccionUsuario',\r\n    component: seleccionUsuario,\r\n    meta: {requiresAuth: true }\r\n  },\r\n]\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(process.env.BASE_URL),\r\n  routes\r\n});\r\n\r\nrouter.beforeEach((to,from,next)=>{\r\n  //\r\n  if(to.matched.some(record=>record.path == '/callback')){\r\n    console.log('router.beforeEach found /callback url')\r\n    Store.dispatch('auth0HandleAuthentication');\r\n    next(false);\r\n  }\r\n  \r\n  let routerAuthCheck = false;\r\n  if(localStorage.getItem('access_token')&& localStorage.getItem('id_token')&& localStorage.getItem('expires_at')){\r\n    console.log('found local storage tokens')\r\n    let expiresAt = JSON.parse(localStorage.getItem('expires_at'))\r\n    routerAuthCheck = new Date().getDate() < expiresAt\r\n  }\r\n  Store.commit('setUserIsAuthenticated', routerAuthCheck);\r\n  if(routerAuthCheck){\r\n    Store.commit('setUserIsAuthenticated', true);\r\n  }\r\n  else{\r\n    Store.commit('setUserIsAuthenticated', false);\r\n  }\r\n  if(to.matched.some(record => record.meta.requiresAuth)){\r\n    if(routerAuthCheck){\r\n      \r\n      next();\r\n    }\r\n    else{\r\n      router.replace('/login');\r\n    }\r\n  }\r\n  else{\r\n    next();\r\n  }\r\n});\r\n\r\n\r\n\r\nexport default router\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}